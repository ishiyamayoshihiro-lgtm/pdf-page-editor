<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF編集ツール</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <h1>PDF編集ツール</h1>

        <!-- タブナビゲーション -->
        <div class="tab-navigation">
            <button class="tab-button active" data-tab="upload">PDFの追加とクリア</button>
            <button class="tab-button" data-tab="split">ページ分割</button>
            <button class="tab-button" data-tab="delete">ページ削除</button>
            <button class="tab-button" data-tab="edit">ページ編集</button>
            <button class="tab-button" data-tab="reorder">ページ並べ替え</button>
            <button class="tab-button" data-tab="mask">マスキング</button>
            <button class="tab-button" data-tab="save">PDFを保存</button>
            <div style="margin-left: auto; display: flex; gap: 10px;">
                <button id="undo-button" class="history-button" disabled title="元に戻す (Ctrl+Z)">↶ 戻る</button>
                <button id="redo-button" class="history-button" disabled title="やり直す (Ctrl+Y)">↷ 進む</button>
            </div>
        </div>

        <!-- PDFアップロードタブ -->
        <div id="upload-tab" class="tab-content active">
            <div class="upload-section">
                <h2>PDFファイルを追加</h2>
                <p><strong>このアプリについて：</strong>スキャンした書類の見開きページ分割、不要ページ削除、ページ回転、順序整理などを視覚的に行い、見やすいPDFに仕上げます。</p>
                <p>編集したいPDFファイルをアップロードします。最大5つまでまとめて選択でき、選択した順にページが追加されます。</p>
                <div class="file-inputs-container">
                    <div class="file-input-row">
                        <label class="file-input-label">1つ目のファイルを選択</label>
                        <input type="file" id="pdf-file-input-1" class="pdf-file-input" accept=".pdf">
                        <span id="filename-display-1" class="filename-display"></span>
                    </div>
                    <div class="file-input-row">
                        <label class="file-input-label">2つ目のファイルを選択</label>
                        <input type="file" id="pdf-file-input-2" class="pdf-file-input" accept=".pdf">
                        <span id="filename-display-2" class="filename-display"></span>
                    </div>
                    <div class="file-input-row">
                        <label class="file-input-label">3つ目のファイルを選択</label>
                        <input type="file" id="pdf-file-input-3" class="pdf-file-input" accept=".pdf">
                        <span id="filename-display-3" class="filename-display"></span>
                    </div>
                    <div class="file-input-row">
                        <label class="file-input-label">4つ目のファイルを選択</label>
                        <input type="file" id="pdf-file-input-4" class="pdf-file-input" accept=".pdf">
                        <span id="filename-display-4" class="filename-display"></span>
                    </div>
                    <div class="file-input-row">
                        <label class="file-input-label">5つ目のファイルを選択</label>
                        <input type="file" id="pdf-file-input-5" class="pdf-file-input" accept=".pdf">
                        <span id="filename-display-5" class="filename-display"></span>
                    </div>
                </div>
                <button id="upload-button">PDFを追加してプレビュー</button>
            </div>
            <div class="controls">
                <h2>全ページのクリア</h2>
                <p>現在読み込まれているすべてのページをクリアして、初めからやり直します。</p>
                <button id="clear-all-button">全ページをクリア</button>
            </div>
            <div class="status">
                <p id="status"></p>
            </div>
            <div id="gallery-upload" class="gallery"></div>
        </div>

        <!-- (他のタブは変更なし) -->
        <div id="split-tab" class="tab-content">
            <div class="placeholder">
                <p>←「PDFの追加とクリア」タブでファイルをアップロードすると、ここにプレビューが表示されます。</p>
            </div>
            <div class="controls sticky">
                <h2>横長ページを分割</h2>
                <p class="description">見開きでスキャンしたページを左右に分割します。横長ページが自動検出され、左右別々のページとして分割されます。</p>
                <button id="split-selected-button" disabled>選択した横長ページを分割</button>
                <button id="split-all-button" disabled>すべての横長ページを分割</button>
                <button id="clear-selection-button-split" disabled>選択をクリア</button>
                <div class="slider-container">
                    <label for="size-slider-split">サムネイルサイズ:</label>
                    <input type="range" id="size-slider-split" min="100" max="400" value="150">
                </div>
            </div>
            <div id="gallery-split" class="gallery"></div>
        </div>

        <div id="delete-tab" class="tab-content">
            <div class="placeholder">
                <p>←「PDFの追加とクリア」タブでファイルをアップロードすると、ここにプレビューが表示されます。</p>
            </div>
            <div class="controls sticky">
                <h2>削除するページをクリックして選択</h2>
                <p class="description">空白ページや不要なページをクリックして選択（赤い枠と「×」マークが表示されます）。複数ページを同時に選択できます。</p>
                <button id="delete-button" disabled>選択したページを削除</button>
                <button id="clear-selection-button-delete" disabled>選択をクリア</button>
                <div class="slider-container">
                    <label for="size-slider-delete">サムネイルサイズ:</label>
                    <input type="range" id="size-slider-delete" min="100" max="400" value="150">
                </div>
            </div>
            <div id="gallery-delete" class="gallery"></div>
        </div>

        <div id="edit-tab" class="tab-content">
            <div class="placeholder">
                <p>←「PDFの追加とクリア」タブでファイルをアップロードすると、ここにプレビューが表示されます。</p>
            </div>
            <div class="controls sticky">
                <h2>回転するページをクリックして選択</h2>
                <p class="description">向きが間違っているページをクリックして選択（黄色い枠が表示されます）。複数ページを同時に選択して回転できます。</p>
                <div class="button-group">
                    <button id="rotate-left-button" disabled>↺ 左90°回転</button>
                    <button id="rotate-right-button" disabled>↻ 右90°回転</button>
                    <button id="clear-selection-button-edit" disabled>選択をクリア</button>
                </div>
                <div class="slider-container">
                    <label for="size-slider-edit">サムネイルサイズ:</label>
                    <input type="range" id="size-slider-edit" min="100" max="400" value="150">
                </div>
            </div>
            <div id="gallery-edit" class="gallery"></div>
        </div>

        <div id="reorder-tab" class="tab-content">
            <div class="placeholder">
                <p>←「PDFの追加とクリア」タブでファイルをアップロードすると、ここにプレビューが表示されます。</p>
            </div>
            <div class="controls sticky">
                <h2>ページを並べ替え</h2>
                <p class="description"><strong>方法1：</strong>クリックした順に並べ替え（選択したページに番号が表示されます）<br>
                <strong>方法2：</strong>1ページ選択して「前へ」「次へ」ボタンで位置を微調整</p>
                <div class="button-group">
                    <button id="apply-order-button" disabled>クリック順で並べ替え</button>
                    <button id="clear-selection-button" disabled>選択をクリア</button>
                </div>
                 <div class="button-group">
                    <button id="swap-odd-even-button" disabled>偶数・奇数ページ入替</button>
                    <button id="reverse-all-button" disabled>全ページ逆順</button>
                </div>
                <div class="move-controls">
                    <h3>または、1ページを選択して移動:</h3>
                    <button id="move-prev-button" disabled>← 前へ</button>
                    <button id="move-next-button" disabled>次へ →</button>
                </div>
                <div class="slider-container">
                    <label for="size-slider-reorder">サムネイルサイズ:</label>
                    <input type="range" id="size-slider-reorder" min="100" max="400" value="150">
                </div>
            </div>
            <div id="gallery-reorder" class="gallery"></div>
        </div>

        <!-- マスキングタブ -->
        <div id="mask-tab" class="tab-content">
            <div class="placeholder">
                <p>←「PDFの追加とクリア」タブでファイルをアップロードすると、ここにプレビューが表示されます。</p>
            </div>
            <div class="controls sticky">
                <h2>領域をマスキング（黒塗り）</h2>
                <p class="description">下のサムネイル一覧からページをクリックして選択すると、大きく表示されます。マスキングしたい領域をマウスでドラッグして選択し、適用ボタンをクリックすると黒塗りされます。</p>
                <div style="margin: 15px 0; display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                    <label for="mask-interval-select">
                        <select id="mask-interval-select" style="padding: 5px 10px; font-size: 14px;">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                        </select>
                    </label>
                    <span>ページ毎に</span>
                    <label for="mask-offset-select">
                        <select id="mask-offset-select" style="padding: 5px 10px; font-size: 14px;">
                            <option value="1">1</option>
                        </select>
                    </label>
                    <span>ページ目にマスキング</span>
                </div>
                <button id="apply-mask-button" disabled>マスキングを適用</button>
                <button id="clear-mask-button" disabled>選択をクリア</button>
                <div id="mask-info" style="margin-top: 10px; color: #666;"></div>
            </div>
            <div class="mask-layout">
                <div class="mask-canvas-wrapper">
                    <div id="mask-canvas-container" style="position: relative;">
                        <canvas id="mask-canvas" style="border: 2px solid #ccc; cursor: crosshair;"></canvas>
                    </div>
                </div>
                <div class="mask-gallery-wrapper">
                    <h3>ページ一覧</h3>
                    <div id="gallery-mask" class="gallery"></div>
                </div>
            </div>
        </div>

        <!-- 保存タブ -->
        <div id="save-tab" class="tab-content">
            <div class="placeholder">
                <p>←「PDFの追加とクリア」タブでファイルをアップロードすると、ここにプレビューが表示されます。</p>
            </div>
            <div class="controls">
                <h2>PDFを生成して保存</h2>
                <p>現在の編集状態を確認し、ボタンをクリックするとPDFファイルが自動的にダウンロードされます。</p>
                <p><strong>💡 ヒント：</strong>各タブ（分割、削除、編集、並べ替え）で行った編集内容はすべて反映されています。タブは任意の順序で使用できます。</p>
                <button id="save-pdf-button" disabled>名前をつけてダウンロード</button>
                <div class="slider-container">
                    <label for="size-slider-save">サムネイルサイズ:</label>
                    <input type="range" id="size-slider-save" min="100" max="400" value="150">
                </div>
            </div>
            <div id="gallery-save" class="gallery"></div>
        </div>
    </div>

    <!-- ファイル名入力モーダル -->
    <div id="filename-modal" class="modal">
        <div class="modal-content">
            <h2>ファイル名を指定してダウンロード</h2>
            <p>保存するPDFファイルの名前を入力してください。</p>
            <div class="modal-input-container">
                <input type="text" id="filename-input" placeholder="ファイル名を入力">
                <span class="pdf-extension">.pdf</span>
            </div>
            <div class="modal-buttons">
                <button id="modal-download-button" class="modal-primary-button">ダウンロード</button>
                <button id="modal-cancel-button" class="modal-secondary-button">キャンセル</button>
            </div>
        </div>
    </div>

    <script src="/static/script.js"></script>
</body>
</html>